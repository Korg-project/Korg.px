"""
Atomic data: symbols, masses, and solar abundances.
"""

import numpy as np
from .constants import amu_cgs

# Atomic symbols for elements H through U
atomic_symbols = [
    "H", "He", "Li", "Be", "B", "C", "N", "O", "F", "Ne",
    "Na", "Mg", "Al", "Si", "P", "S", "Cl", "Ar", "K", "Ca",
    "Sc", "Ti", "V", "Cr", "Mn", "Fe", "Co", "Ni", "Cu", "Zn",
    "Ga", "Ge", "As", "Se", "Br", "Kr", "Rb", "Sr", "Y", "Zr",
    "Nb", "Mo", "Tc", "Ru", "Rh", "Pd", "Ag", "Cd", "In", "Sn",
    "Sb", "Te", "I", "Xe", "Cs", "Ba", "La", "Ce", "Pr", "Nd",
    "Pm", "Sm", "Eu", "Gd", "Tb", "Dy", "Ho", "Er", "Tm", "Yb",
    "Lu", "Hf", "Ta", "W", "Re", "Os", "Ir", "Pt", "Au", "Hg",
    "Tl", "Pb", "Bi", "Po", "At", "Rn", "Fr", "Ra", "Ac", "Th",
    "Pa", "U"
]

MAX_ATOMIC_NUMBER = len(atomic_symbols)

# Dictionary mapping symbols to atomic numbers (1-indexed)
atomic_numbers = {symbol: i+1 for i, symbol in enumerate(atomic_symbols)}

# Atomic masses in grams (already multiplied by amu_cgs in Julia)
atomic_masses = np.array([
    1.008, 4.003, 6.941, 9.012, 10.81, 12.01, 14.01, 16.00, 19.00, 20.18,
    22.99, 24.31, 26.98, 28.08, 30.97, 32.06, 35.45, 39.95, 39.10, 40.08,
    44.96, 47.90, 50.94, 52.00, 54.94, 55.85, 58.93, 58.71, 63.55, 65.37,
    69.72, 72.59, 74.92, 78.96, 79.90, 83.80, 85.47, 87.62, 88.91, 91.22,
    92.91, 95.94, 98.91, 101.1, 102.9, 106.4, 107.9, 112.4, 114.8, 118.7,
    121.8, 127.6, 126.9, 131.3, 132.9, 137.3, 138.9, 140.1, 140.9, 144.2,
    145.0, 150.4, 152.0, 157.3, 158.9, 162.5, 164.9, 167.3, 168.9, 173.0,
    175.0, 178.5, 181.0, 183.9, 186.2, 190.2, 192.2, 195.1, 197.0, 200.6,
    204.4, 207.2, 209.0, 210.0, 210.0, 222.0, 223.0, 226.0, 227.0, 232.0,
    231.0, 238.0
]) * amu_cgs

# Solar/meteoritic abundances per Asplund et al. (2009, Ann. Rev. Ast. Ap., 47, 481)
asplund_2009_solar_abundances = np.array([
    12.00, 10.93, 1.05, 1.38, 2.70, 8.43, 7.83, 8.69, 4.56, 7.93,
    6.24, 7.60, 6.45, 7.51, 5.41, 7.12, 5.50, 6.40, 5.03, 6.34,
    3.15, 4.95, 3.93, 5.64, 5.43, 7.50, 4.99, 6.22, 4.19, 4.56,
    3.04, 3.65, 2.30, 3.34, 2.54, 3.25, 2.52, 2.87, 2.21, 2.58,
    1.46, 1.88, -5.00, 1.75, 0.91, 1.57, 0.94, 1.71, 0.80, 2.04,
    1.01, 2.18, 1.55, 2.24, 1.08, 2.18, 1.10, 1.58, 0.72, 1.42,
    -5.00, 0.96, 0.52, 1.07, 0.30, 1.10, 0.48, 0.92, 0.10, 0.84,
    0.10, 0.85, -0.12, 0.85, 0.26, 1.40, 1.38, 1.62, 0.92, 1.17,
    0.90, 1.75, 0.65, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, 0.02,
    -5.00, -0.54
])

# Solar/meteoritic abundances per Asplund et al. A&A 653, A141 (2021)
asplund_2020_solar_abundances = np.array([
    12.00, 10.91, 0.96, 1.38, 2.70, 8.46, 7.83, 8.69, 4.40, 8.06,
    6.22, 7.55, 6.43, 7.51, 5.41, 7.12, 5.31, 6.38, 5.07, 6.30,
    3.14, 4.97, 3.90, 5.62, 5.42, 7.46, 4.94, 6.20, 4.18, 4.56,
    3.02, 3.62, 2.30, 3.34, 2.54, 3.12, 2.32, 2.83, 2.21, 2.59,
    1.47, 1.88, -5.00, 1.75, 0.78, 1.57, 0.96, 1.71, 0.80, 2.02,
    1.01, 2.18, 1.55, 2.22, 1.08, 2.27, 1.11, 1.58, 0.75, 1.42,
    -5.00, 0.95, 0.52, 1.08, 0.31, 1.10, 0.48, 0.93, 0.11, 0.85,
    0.10, 0.85, -0.15, 0.79, 0.26, 1.35, 1.32, 1.61, 0.91, 1.17,
    0.92, 1.95, 0.65, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, 0.03,
    -5.00, -0.54
])

# Solar abundances per Grevesse et al. Space Sci Rev (2007) 130: 105–114
grevesse_2007_solar_abundances = np.array([
    12.00, 10.93, 1.05, 1.38, 2.70, 8.39, 7.78, 8.66, 4.56, 7.84,
    6.17, 7.53, 6.37, 7.51, 5.36, 7.14, 5.50, 6.18, 5.08, 6.31,
    3.17, 4.90, 4.00, 5.64, 5.39, 7.45, 4.92, 6.23, 4.21, 4.60,
    2.88, 3.58, 2.29, 3.33, 2.56, 3.25, 2.60, 2.92, 2.21, 2.58,
    1.42, 1.92, -5.00, 1.84, 1.12, 1.66, 0.94, 1.77, 1.60, 2.00,
    1.00, 2.19, 1.51, 2.24, 1.07, 2.17, 1.13, 1.70, 0.58, 1.45,
    -5.00, 1.00, 0.52, 1.11, 0.28, 1.14, 0.51, 0.93, 0.00, 1.08,
    0.06, 0.88, -0.17, 1.11, 0.23, 1.25, 1.38, 1.64, 1.01, 1.13,
    0.90, 2.00, 0.65, -5.00, -5.00, -5.00, -5.00, -5.00, -5.00, 0.06,
    -5.00, -0.52
])

# Solar abundances from Bergemann, Lodders, and Palme (2025)
# https://zenodo.org/records/14988840
# Solar convective-zone abundances are used when available, chondritic abundances are used otherwise
bergemann_2025_solar_abundances = np.array([
    12.0, 10.922, 1.04, 1.21, 2.7, 8.51, 7.94, 8.76, 4.4, 8.15,
    6.29, 7.58, 6.43, 7.56, 5.44, 7.16, 5.43, 6.5, 5.09, 6.35,
    3.13, 4.97, 3.89, 5.74, 5.52, 7.51, 4.95, 6.24, 4.24, 4.55,
    3.02, 3.62, 2.34, 3.41, 2.65, 3.31, 2.35, 2.93, 2.3, 2.68,
    1.47, 1.88, -5.0, 1.75, 0.78, 1.57, 0.96, 1.77, 0.8, 2.02,
    1.08, 2.23, 1.76, 2.3, 1.12, 2.27, 1.1, 1.58, 0.75, 1.42,
    -5.0, 0.95, 0.57, 1.08, 0.31, 1.1, 0.48, 0.93, 0.11, 0.85,
    0.1, 0.86, -0.11, 0.79, 0.3, 1.36, 1.42, 1.64, 0.91, 1.14,
    0.95, 1.95, 0.7, -5.0, -5.0, -5.0, -5.0, -5.0, -5.0, 0.09,
    -5.0, -0.5
])

# Solar abundances per Magg et al. A&A 661, A140 (2022)
# doi:10.1051/0004-6361/202140401
# Those not specified in Magg et al. are taken from Bergemann et al. (2025)
magg_2022_solar_abundances = bergemann_2025_solar_abundances.copy()
magg_photospheric = {
    "C": 8.56,
    "N": 7.98,
    "O": 8.77,
    "F": 4.40,
    "Ne": 8.15,
    "Na": 6.29,
    "Mg": 7.55,
    "Al": 6.43,
    "Si": 7.59,
    "P": 5.41,
    "S": 7.16,
    "Cl": 5.25,
    "Ar": 6.50,
    "K": 5.14,
    "Ca": 6.37,
    "Sc": 3.07,
    "Ti": 4.94,
    "V": 3.89,
    "Cr": 5.74,
    "Mn": 5.52,
    "Fe": 7.50,
    "Co": 4.95,
    "Ni": 6.24
}
for symbol, abundance in magg_photospheric.items():
    magg_2022_solar_abundances[atomic_numbers[symbol] - 1] = abundance

# Korg's default solar abundances
default_solar_abundances = bergemann_2025_solar_abundances

# Ionization energies in eV from Barklem & Collet 2016
# Dictionary mapping Z (atomic number) to [χ₁, χ₂, χ₃] (first, second, third ionization energies)
# A value of -1.0 indicates the ionization energy is not available
ionization_energies = {
    1: [13.5984, -1.000, -1.000],   # H
    2: [24.5874, 54.418, -1.000],   # He
    3: [5.3917, 75.640, 122.454],   # Li
    4: [9.3227, 18.211, 153.896],   # Be
    5: [8.2980, 25.155, 37.931],    # B
    6: [11.2603, 24.385, 47.888],   # C
    7: [14.5341, 29.601, 47.445],   # N
    8: [13.6181, 35.121, 54.936],   # O
    9: [17.4228, 34.971, 62.708],   # F
    10: [21.5645, 40.963, 63.423],  # Ne
    11: [5.1391, 47.286, 71.620],   # Na
    12: [7.6462, 15.035, 80.144],   # Mg
    13: [5.9858, 18.829, 28.448],   # Al
    14: [8.1517, 16.346, 33.493],   # Si
    15: [10.4867, 19.769, 30.203],  # P
    16: [10.3600, 23.338, 34.856],  # S
    17: [12.9676, 23.814, 39.800],  # Cl
    18: [15.7596, 27.630, 40.735],  # Ar
    19: [4.3407, 31.625, 45.803],   # K
    20: [6.1132, 11.872, 50.913],   # Ca
    21: [6.5615, 12.800, 24.757],   # Sc
    22: [6.8281, 13.575, 27.492],   # Ti
    23: [6.7462, 14.620, 29.311],   # V
    24: [6.7665, 16.486, 30.960],   # Cr
    25: [7.4340, 15.640, 33.668],   # Mn
    26: [7.9025, 16.199, 30.651],   # Fe
    27: [7.8810, 17.084, 33.500],   # Co
    28: [7.6399, 18.169, 35.190],   # Ni
    29: [7.7264, 20.292, 36.841],   # Cu
    30: [9.3942, 17.964, 39.723],   # Zn
    31: [5.9993, 20.515, 30.726],   # Ga
    32: [7.8994, 15.935, 34.058],   # Ge
    33: [9.7890, 18.589, 28.349],   # As
    34: [9.7524, 21.196, 31.697],   # Se
    35: [11.8138, 21.591, 35.000],  # Br
    36: [13.9996, 24.360, 35.670],  # Kr
    37: [4.1771, 27.290, 39.247],   # Rb
    38: [5.6949, 11.030, 42.884],   # Sr
    39: [6.2173, 12.224, 20.524],   # Y
    40: [6.6339, 13.130, 23.170],   # Zr
    41: [6.7589, 14.320, 25.000],   # Nb
    42: [7.0924, 16.160, 27.130],   # Mo
    43: [7.1194, 15.260, 29.550],   # Tc
    44: [7.3605, 16.760, 28.470],   # Ru
    45: [7.4589, 18.080, 31.060],   # Rh
    46: [8.3369, 19.430, 32.930],   # Pd
    47: [7.5762, 21.484, 34.830],   # Ag
    48: [8.9938, 16.908, 37.470],   # Cd
    49: [5.7864, 18.870, 28.044],   # In
    50: [7.3439, 14.632, 30.503],   # Sn
    51: [8.6084, 16.630, 25.323],   # Sb
    52: [9.0097, 19.000, 27.838],   # Te
    53: [10.4513, 19.131, 29.570],  # I
    54: [12.1298, 20.975, 31.050],  # Xe
    55: [3.8939, 23.157, 33.195],   # Cs
    56: [5.2117, 10.004, 35.840],   # Ba
    57: [5.5769, 11.185, 19.177],   # La
    58: [5.5386, 10.850, 20.197],   # Ce
    59: [5.4730, 10.550, 21.624],   # Pr
    60: [5.5250, 10.720, 22.140],   # Nd
    61: [5.5820, 10.900, 22.000],   # Pm
    62: [5.6437, 11.070, 23.400],   # Sm
    63: [5.6704, 11.241, 24.900],   # Eu
    64: [6.1498, 12.090, 20.630],   # Gd
    65: [5.8638, 11.520, 21.910],   # Tb
    66: [5.9391, 11.670, 22.930],   # Dy
    67: [6.0215, 11.800, 22.840],   # Ho
    68: [6.1077, 11.930, 22.740],   # Er
    69: [6.1843, 12.050, 23.700],   # Tm
    70: [6.2542, 12.179, 25.053],   # Yb
    71: [5.4259, 13.900, 20.955],   # Lu
    72: [6.8251, 15.000, 23.280],   # Hf
    73: [7.5496, 16.200, 23.100],   # Ta
    74: [7.8640, 16.400, 26.020],   # W
    75: [7.8335, 16.600, 27.000],   # Re
    76: [8.4382, 17.000, 25.000],   # Os
    77: [8.9670, 17.000, 28.000],   # Ir
    78: [8.9588, 18.560, 29.000],   # Pt
    79: [9.2256, 20.203, 30.000],   # Au
    80: [10.4375, 18.757, 34.460],  # Hg
    81: [6.1083, 20.428, 29.852],   # Tl
    82: [7.4167, 15.032, 31.937],   # Pb
    83: [7.2855, 16.703, 25.563],   # Bi
    84: [8.4140, 19.300, 27.000],   # Po
    85: [9.3175, 17.880, 26.580],   # At
    86: [10.7485, 21.400, 29.400],  # Rn
    87: [4.0727, 22.400, 33.000],   # Fr
    88: [5.2784, 10.147, 31.000],   # Ra
    89: [5.3802, 11.750, 17.431],   # Ac
    90: [6.3067, 11.900, 18.320],   # Th
    91: [5.8900, 11.900, 19.000],   # Pa
    92: [6.1940, 11.590, 19.800],   # U
}
